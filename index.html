<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#87CEEB" id="themeColor">
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="365 D√≠as de Luz">
    <title>365 D√≠as de Luz</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0;
            margin: 0;
            transition: all 1s ease;
            overflow: hidden;
        }
        
        /* TEMA D√çA SOLEADO */
        body.sunny {
            background: linear-gradient(180deg, #87CEEB 0%, #E0F6FF 50%, #FFF8DC 100%);
        }
        
        /* TEMA NOCHE */
        body.night {
            background: linear-gradient(180deg, #0B1026 0%, #1a237e 50%, #283593 100%);
        }
        
        /* TEMA LLUVIA */
        body.rainy {
            background: linear-gradient(180deg, #4A5568 0%, #667eea 50%, #764ba2 100%);
        }
        
        /* Efectos de clima */
        .weather-effects {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }
        
        /* Nubes */
        .cloud {
            position: absolute;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 100px;
            opacity: 0.7;
            animation: float-cloud 60s linear infinite;
        }
        
        .cloud::before,
        .cloud::after {
            content: '';
            position: absolute;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 100px;
        }
        
        .cloud::before {
            width: 50px;
            height: 50px;
            top: -25px;
            left: 10px;
        }
        
        .cloud::after {
            width: 60px;
            height: 60px;
            top: -30px;
            right: 10px;
        }
        
        @keyframes float-cloud {
            from { transform: translateX(-200px); }
            to { transform: translateX(calc(100vw + 200px)); }
        }
        
        /* Estrellas */
        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s ease-in-out infinite;
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }
        
        /* Sol */
        .sun {
            position: absolute;
            top: 60px;
            right: 60px;
            width: 100px;
            height: 100px;
            background: #FFD700;
            border-radius: 50%;
            box-shadow: 0 0 60px #FFD700, 0 0 100px #FFA500;
            animation: pulse-sun 4s ease-in-out infinite;
        }
        
        @keyframes pulse-sun {
            0%, 100% { transform: scale(1); box-shadow: 0 0 60px #FFD700, 0 0 100px #FFA500; }
            50% { transform: scale(1.1); box-shadow: 0 0 80px #FFD700, 0 0 120px #FFA500; }
        }
        
        /* Luna */
        .moon {
            position: absolute;
            top: 60px;
            right: 60px;
            width: 80px;
            height: 80px;
            background: #F0E68C;
            border-radius: 50%;
            box-shadow: 0 0 40px rgba(240, 230, 140, 0.8);
            position: relative;
        }
        
        .moon::before {
            content: '';
            position: absolute;
            top: 10px;
            left: 20px;
            width: 50px;
            height: 50px;
            background: rgba(240, 230, 140, 0.4);
            border-radius: 50%;
        }
        
        /* Gotas de lluvia */
        .raindrop {
            position: absolute;
            width: 2px;
            height: 40px;
            background: linear-gradient(to bottom, transparent, rgba(174, 194, 224, 0.8));
            animation: fall linear infinite;
        }
        
        @keyframes fall {
            to { transform: translateY(100vh); }
        }
        
        /* Rel√°mpago */
        .lightning {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.9);
            opacity: 0;
            animation: flash 8s ease-in-out infinite;
        }
        
        @keyframes flash {
            0%, 90%, 92%, 100% { opacity: 0; }
            91% { opacity: 1; }
        }
        
        /* Container del widget */
        .widget-container {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 30px;
            padding: 30px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            z-index: 10;
            transition: all 0.5s ease;
        }
        
        body.night .widget-container {
            background: rgba(26, 35, 126, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        body.rainy .widget-container {
            background: rgba(74, 85, 104, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.15);
        }
        
        .hidden { display: none; }
        
        /* Login screen */
        .login-emoji {
            font-size: 4em;
            margin-bottom: 20px;
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        h1 {
            color: white;
            font-size: 2em;
            margin-bottom: 10px;
            font-weight: 600;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
        .subtitle {
            color: rgba(255, 255, 255, 0.9);
            font-style: italic;
            margin-bottom: 25px;
            font-size: 0.9em;
            text-shadow: 0 1px 5px rgba(0, 0, 0, 0.2);
        }
        
        .input-group {
            text-align: left;
            margin: 15px 0;
        }
        
        .input-group label {
            display: block;
            color: white;
            font-weight: 500;
            margin-bottom: 8px;
            font-size: 0.9em;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }
        
        input[type="text"],
        input[type="date"] {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            font-size: 1em;
            background: rgba(255, 255, 255, 0.9);
            transition: all 0.3s ease;
        }
        
        input:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.6);
            background: white;
        }
        
        button {
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            border: none;
            padding: 12px 24px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.95em;
            font-weight: 600;
            margin: 10px 5px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
            background: white;
        }
        
        button:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }
        
        /* Widget content */
        .widget-header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .day-number {
            font-size: 3em;
            color: white;
            font-weight: 700;
            text-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
            margin-bottom: 5px;
        }
        
        .date-display {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.9em;
            text-shadow: 0 1px 5px rgba(0, 0, 0, 0.2);
            text-transform: capitalize;
        }
        
        .weather-icon {
            font-size: 3em;
            margin: 20px 0;
            animation: float 3s ease-in-out infinite;
        }
        
        .message-box {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 25px;
            border-radius: 20px;
            margin: 20px 0;
            text-align: center;
            transition: all 0.5s ease;
        }
        
        .message-text {
            color: white;
            font-size: 1.1em;
            line-height: 1.6;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }
        
        .hashtag {
            display: block;
            margin-top: 15px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.85em;
            font-weight: 600;
        }
        
        .navigation {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }
        
        .nav-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 10px 20px;
            border-radius: 15px;
            font-size: 0.9em;
        }
        
        .nav-btn:hover:not(:disabled) {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .birthday-special {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            padding: 25px;
            border-radius: 20px;
            margin-bottom: 20px;
            text-align: center;
            animation: pulse 2s ease-in-out infinite;
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.5);
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        
        .birthday-emoji {
            font-size: 3em;
            margin-bottom: 10px;
        }
        
        .birthday-text {
            color: white;
            font-size: 1.3em;
            font-weight: 700;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            animation: confetti-fall 4s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
            z-index: 9999;
        }
        
        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }
        
        .locked-message {
            color: rgba(255, 255, 255, 0.7);
            font-style: italic;
        }
        
        .reflection-box {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 15px;
            margin-top: 15px;
        }
        
        .reflection-box label {
            display: block;
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.85em;
            margin-bottom: 8px;
        }
        
        .reflection-box textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            font-size: 0.9em;
            resize: vertical;
            min-height: 60px;
            background: rgba(255, 255, 255, 0.9);
            transition: all 0.3s ease;
        }
        
        .reflection-box textarea:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.6);
            background: white;
        }
    </style>
</head>
<body class="sunny">
    <div class="weather-effects" id="weatherEffects"></div>
    
    <div class="widget-container">
        <div id="loginScreen">
            <div class="login-emoji">‚ú®</div>
            <h1>365 D√≠as de Luz</h1>
            <p class="subtitle">Un mensaje diario para iluminar tu vida</p>
            
            <div class="input-group">
                <label for="userName">Tu nombre:</label>
                <input type="text" id="userName" placeholder="Escribe tu nombre" required>
            </div>
            
            <div class="input-group">
                <label for="userBirthday">Tu cumplea√±os:</label>
                <input type="date" id="userBirthday" required>
            </div>
            
            <button onclick="login()">üéÅ Comenzar</button>
        </div>

        <div id="widgetScreen" class="hidden">
            <div class="widget-header">
                <div class="weather-icon" id="weatherIcon">‚òÄÔ∏è</div>
                <div class="day-number" id="dayNumber">D√≠a 1</div>
                <div class="date-display" id="dateDisplay"></div>
            </div>
            
            <div id="birthdaySpecial"></div>
            
            <div class="message-box">
                <p class="message-text" id="messageText"></p>
                <span class="hashtag" id="hashtag">#EresLuz</span>
            </div>

            <div class="reflection-box">
                <label>‚úçÔ∏è ¬øC√≥mo te sientes hoy?</label>
                <textarea id="reflectionText" placeholder="Escribe aqu√≠..."></textarea>
            </div>
            
            <div class="navigation">
                <button class="nav-btn" onclick="previousDay()">‚Üê Anterior</button>
                <button class="nav-btn" onclick="showToday()">üìÖ Hoy</button>
                <button class="nav-btn" id="nextBtn" onclick="nextDay()">Siguiente ‚Üí</button>
            </div>
        </div>
    </div>

    <script>
        // CONFIGURA TU API KEY DE OPENWEATHER AQU√ç
        const WEATHER_API_KEY = 'TU_API_KEY_AQUI';
        
        let currentDate = new Date();
        let userData = null;
        let reflections = {};
        let currentWeather = 'sunny';
        
        const phrases = "Tu sonrisa tiene poder, √∫sala hoy.|üòä|No necesitas hacerlo perfecto, solo hacerlo con el coraz√≥n.|üíñ|Eres suficiente, incluso en tus d√≠as m√°s simples.|‚ú®|Hoy es un buen d√≠a para empezar de nuevo.|üåÖ|Cada paso peque√±o cuenta, no lo olvides.|üë£|La calma tambi√©n es progreso.|üåä|Tienes un brillo que nadie puede copiar.|‚≠ê|Lo que haces con amor siempre deja huella.|üíù|Respira, vas bien.|üå¨Ô∏è|No corras, las flores no florecen de prisa.|üå∏|Mereces todo lo bonito que est√°s buscando.|üå∫|Lo que das, vuelve.|üîÑ|Eres m√°s fuerte de lo que piensas.|üí™|Tu energ√≠a cambia los lugares donde vas.|‚ú®|Hoy elige verte con cari√±o.|üíï|Lo est√°s intentando, y eso ya vale mucho.|üåü|No necesitas validaci√≥n para ser valiosa.|üëë|A veces descansar tambi√©n es avanzar.|üõèÔ∏è|Cada d√≠a puedes reinventarte un poco.|ü¶ã|Eres luz, aunque no todos lo noten.|üí°|Tu historia es √∫nica.|üìñ|Los d√≠as buenos llegan.|‚è≥|Agradece lo que tienes.|üôè|Elige la paz.|‚òÆÔ∏è|Tu voz importa.|üó£Ô∏è|Has superado tanto.|üèîÔ∏è|Lo mejor est√° por venir.|üéÅ|S√© t√∫ misma.|üåà|El alma necesita descanso.|üå¨Ô∏è|Las cosas buenas toman tiempo.|‚è∞|Tu presencia es un regalo.|üéÄ|S√© amable contigo.|üíó|No te castigues por sentir.|üíô|Hoy puede ense√±arte.|üìö|Sigue adelante.|üê¢|Los errores te fortalecen.|üíé|No apagues tu luz.|üí´|Tienes tanto por dar.|üéÅ|No necesitas claridad total.|üß≠|Disfruta sin culpa.|üåª|Tu coraz√≥n sabe.|‚ù§Ô∏è|Sonr√≠e hoy.|üòä|Puedes cambiar.|üîÑ|Has llegado lejos.|üó∫Ô∏è|Tu bondad es fuerza.|üåü|No todo debe tener sentido.|üåô|Hoy cuenta.|üçÉ|Haz espacio para el bien.|üè°|Lo simple es hermoso.|üåø|Conf√≠a en el proceso.|üîÆ|Descansa.|üò¥|Elige ver lo bueno.|üëÄ|El sol tarda en salir.|üåÖ|Eres capaz.|üí™|No hay prisa.|üå∑|Cada d√≠a es nuevo.|üåÑ|Lo est√°s haciendo bien.|üåü|Ya vales.|üëë|Respira profundo.|üå¨Ô∏è|La ternura es fortaleza.|üå∏|Has crecido.|üå±|Agradece.|üôè|Descansa si te cansas.|üòå|Eres parte de algo bonito.|üå∫|Est√°s avanzando.|üö∂|Tu cuidado cuenta.|üíû|Empezar de cero es valiente.|üî•|Mereces calma.|üïäÔ∏è|Coraz√≥n valiente.|üíñ|Date cr√©dito.|üèÜ|No necesitas producir.|‚ú®|Eres suficiente en silencio.|ü§´|La esperanza llega.|üå§Ô∏è|Elige tu ritmo.|üéµ|La bondad vuelve.|üîÑ|Algunas cosas se sienten.|üí´|El mundo te sostiene.|üåç|Las victorias peque√±as importan.|üéâ|Puedes so√±ar.|üå†|Cree en ti.|‚≠ê|Eres capaz.|üí™|No te exijas tanto.|üåº|Agradece tus pasos.|üë£|Est√°s aprendiendo.|üìö|Disfruta lento.|üêå|No necesitas todas las respuestas.|‚ùì|Ya eres hermosa.|üåπ|Suelta el control.|üéà|Mereces lo bueno.|üíù|Celebra tus avances.|üéä|El tiempo ense√±a.|‚è≥|Sonr√≠e m√°s.|üòä|Eres un proceso.|üîß|Tu ternura cambia.|üåé|Nadie m√°s es t√∫.|‚ú®|Mereces amor.|‚ù§Ô∏è|Eres diferente y brillante.|üíé|No todo se mide.|üìä|Siente orgullo.|ü¶Å|Est√°s creciendo.|üå≥|La calma llega.|üåä|No apagues tu entusiasmo.|üî•|Tus pasos son valientes.|üë£|Puedes empezar otra vez.|üåÖ|Eres parte de algo grande.|üåå|Necesitar tiempo est√° bien.|‚è∞|Cada d√≠a te acerca.|ü¶ã|Tus sue√±os merecen espacio.|üí≠|Eres luz.|üí°|No controles todo.|üéÆ|Descansa sin culpa.|üõå|Tu esfuerzo vale.|üèÖ|S√© paciente contigo.|‚è≥|El amor florece.|üåª|Eres valiente.|ü¶∏|El rumbo importa.|üß≠|Eres constante.|‚õ∞Ô∏è|Descansar es sabio.|üòå|No necesitas validaci√≥n.|üí´|Tu paz vale m√°s.|‚òÆÔ∏è|Aprendes a quererte.|üíó|La magia est√° en lo peque√±o.|‚ú®|Agradece lo simple.|üçÇ|Eres resiliente.|üí™|Mira al cielo.|‚òÅÔ∏è|Lo haces bien.|üëç|La felicidad se cultiva.|üå±|Conf√≠a en la vida.|üåà|Eres luz siempre.|üå•Ô∏è|Tu ternura es regalo.|üéÅ|Cada d√≠a cuenta.|üìÜ|No siempre debes ser fuerte.|üõ°Ô∏è|El descanso es parte.|üö∂|Eres importante.|‚≠ê|Suelta el peso.|üéà|El amor vuelve.|üíï|Aprendes a vivir.|üåü|Tu forma de amar importa.|üíñ|Cree en lo bueno.|üå†|Eres valiente.|ü¶Å|Vas bien.|üö∂|La esperanza encuentra camino.|üåÖ|No necesitas plan perfecto.|üìù|Est√°s donde debes.|üìç|La vida es intentarlo.|üéØ|No juzgues tus pausas.|‚è∏Ô∏è|Tu coraz√≥n late.|üíì|Elige calma.|üïäÔ∏è|Hoy te fortalece.|üí™|El cambio llega.|üå±|Comparte amor contigo.|üíù|Est√°s floreciendo.|üå∫|Conf√≠a en tu camino.|üõ§Ô∏è|Tu existencia es suficiente.|‚ú®|S√© aut√©ntica.|üåü|Eres historia hermosa.|üìñ|Simplemente sigue.|‚û°Ô∏è|Abr√°zate con paciencia.|ü§ó|Lo haces bien.|üëÄ|Cada d√≠a renace.|üåÑ|Eres capaz siempre.|üí™|Sonr√≠e.|üòä|Cuida tu energ√≠a.|‚ö°|La bondad deja huella.|üë£|Eres inspiraci√≥n.|üí´|Hoy siembras ma√±ana.|üå∑|Aprende a brillar.|‚ú®|No subestimes tu crecimiento.|üìà|Respira y sigue.|üå¨Ô∏è|Eres fuerte.|üí™|El universo te recuerda.|üåå|Lo logras poco a poco.|üéØ|Elige paz.|üîá|Eres incre√≠ble.|üåü|Todo tiene momento.|‚è∞|No te castigues.|ü©π|Eres arte.|üé®|D√©jate sorprender.|üéÅ|Eres luminosa.|‚ú®|No pierdas la fe.|üí≠|Tu luz gu√≠a.|üî¶|Haz algo bueno.|üíö|Eres valiosa.|üíé|Hoy te transforma.|ü¶ã|Mereces suavidad.|‚òÅÔ∏è|Deja respirar tu alma.|üå¨Ô∏è|Eres suficiente.|‚ú®|Ya tienes lo esencial.|üíù|Date tiempo.|‚è≥|Te quieres con calma.|üíó|La ternura es fuerza.|üå∏|Tu ritmo es perfecto.|üéµ|Eres luz siempre.|üí°|Agradece lo que tienes.|üôè|Tu esencia es hermosa.|üåπ|Lo haces lo mejor.|üëè|Respira y conf√≠a.|üå¨Ô∏è|Eres milagro.|‚ú®|Los sue√±os son reales.|üå†|Creces en silencio.|üå±|Elige ver bonito.|üëÅÔ∏è|Tu paz es prioridad.|‚òÆÔ∏è|Disfruta el presente.|üéÅ|Alma fuerte y sensible.|üíñ|Da un paso m√°s.|üë£|Tu camino tiene sentido.|üõ§Ô∏è|Eres inspiraci√≥n.|üí´|Conf√≠a en tus decisiones.|‚úîÔ∏è|Aprende a soltar.|üéà|Eres suficiente.|‚≠ê|Celebra tu historia.|üéâ|Descubre m√°s.|üîç|Crea belleza.|üé®|Abraza emociones.|ü§ó|Est√°s sanando.|ü©π|Tu esfuerzo se ve.|üëÄ|Cree m√°s en ti.|üí™|Eres amor.|‚ù§Ô∏è|Lo bueno no duele.|üåà|Deja fluir.|üåä|Puedes lograrlo.|üèÜ|Eres √∫nica.|üíé|Respira sin prisa.|üå¨Ô∏è|Eres bonita.|üå∫|Todo mejora.|üìà|Tu luz no depende del clima.|‚òÄÔ∏è|Aprendes a cuidarte.|üíö|Date un momento.|üßò|Eres suficiente en pausa.|‚è∏Ô∏è|No todo es perfecto.|üå∏|Agradece avances.|üìä|Eres fuerza en calma.|üåä|Elige amor.|üíï|Creces con intentos.|üå±|Tu ternura cambia d√≠as.|üåº|Sonr√≠e sin raz√≥n.|üòä|Eres resiliente.|üí™|Recuerda lo lejos.|üó∫Ô∏è|D√©jate abrazar.|ü§ó|Vale la pena.|‚ú®|Conf√≠a en el proceso.|üîÑ|Est√°s brillando.|üí´|Eres amor en movimiento.|‚ù§Ô∏è|Date cr√©dito.|üèÖ|Eres m√°s que suficiente.|üëë|Encuentra belleza simple.|üçÉ|Lo haces genial.|üåü|Eres esperanza.|üåÖ|Suelta culpa.|üéà|Eres paz.|‚òÆÔ∏è|Abr√°zate con cari√±o.|ü§ó|Eres parte grande.|üåå|Conf√≠a sin dudar.|üí™|Tu alma merece descanso.|üò¥|Ve el lado bueno.|üòä|Eres el sol.|‚òÄÔ∏è|No te exijas.|üå∏|Eres hermosa siempre.|üåπ|Siente sin miedo.|üíô|Eres m√°s capaz.|üí™|Respira y suelta.|üå¨Ô∏è|Tu historia se construye.|üèóÔ∏è|Agradece existir.|üôè|Eres amor.|‚ù§Ô∏è|Vales mucho.|üíé|Aprendes a florecer.|üå∫|Conf√≠a en fuerza.|üí™|Coraz√≥n valiente.|ü¶Å|Descansa sin culpa.|üòå|Logras cosas grandes.|üèÜ|Busca calma dentro.|üßò|Eres luz llena.|‚ú®|Sonr√≠e a la vida.|üòä|Haces lo correcto.|‚úîÔ∏è|Cree en finales felices.|üåà|Eres luz para todos.|üí°|Elige ternura.|üíó|Eres suficiente siempre.|‚≠ê|Aprecia lo que tienes.|üôè|Eres fuerza y dulzura.|üå∏|Deja que esperanza gu√≠e.|üåü|Eres buen recuerdo.|üì∏|S√© paciente.|‚è≥|Eres valiente aqu√≠.|üí™|Conf√≠a intuici√≥n.|üîÆ|Mereces amor verdadero.|üíñ|Agradece camino.|üõ§Ô∏è|Eres inspiraci√≥n silenciosa.|üåô|Da paso con fe.|üë£|Eres parte hermosa.|üå∫|Puedes empezar otra vez.|üåÖ|Eres magia.|‚ú®|Suelta lo viejo.|üéà|Eres alegr√≠a.|üòä|Celebra existencia.|üéâ|Eres constancia.|üåä|Todo pasa.|‚è∞|Eres m√°s que errores.|‚≠ê|Vive con gratitud.|üôè|Eres luz creyendo.|üí°|Descansa.|üõå|Eres importante para alguien.|üíù|Suelta miedo.|üéà|Eres historia evolutiva.|üìñ|Conf√≠a milagros.|‚ú®|Eres suficiente sin condiciones.|üíñ|Cree posibilidades.|üåü|Eres parte buena.|üåà|Abraza lo que eres.|ü§ó|Eres fuerte que dudas.|üí™|Elige amor todo.|‚ù§Ô∏è|Eres chispa esperanza.|‚ú®|Disfruta lo haces.|üòä|Eres capaz so√±ar.|üå†|S√© amable contigo.|üíó|Eres luz tormenta.|‚õàÔ∏è|Agradece aprendido.|üìö|Eres alma hermosa.|üí´|Conf√≠a futuro.|üîÆ|Eres faro dem√°s.|üóº|Respira sigue.|üå¨Ô∏è|Eres amor calma fuerza.|üí™|No olvides sonre√≠r.|üòä|Eres resiliencia.|üìñ|Todo se acomoda.|üß©|Eres hermosa eres.|üåπ|Ve bueno en ti.|üëÅÔ∏è|Eres prueba luz vuelve.|üåÖ|Suelta pesa.|üéà|Eres sentido.|üåü|Celebra victorias.|üéä|Eres expansi√≥n.|üåå|Elige cuidarte.|üíö|Eres todo necesitas.|‚ú®|Mereces cosas buenas.|üéÅ|Eres fuerte miedos.|üí™|Agradece presente.|üéÅ|Eres coraz√≥n amor.|‚ù§Ô∏è|Descansa sin remordimientos.|üò¥|Eres √∫nica especial.|üíé|Sigue creyendo.|‚≠ê|Eres calma buscas.|üåä|Conf√≠a tiempo.|‚è∞|Puedes volver empezar.|üåÖ|Deja vida fluir.|üåä|Eres digna amor.|üíñ|Agradece fuiste eres.|üôè|Eres promesa cumplida.|‚úÖ|Conf√≠a poder simple.|üçÉ|Eres abrazo mundo.|ü§ó|Deja espacio esperanza.|üåü|Eres recordatorio bondad.|üíù|Vive ligereza.|üéà|Eres todo necesitas.|‚ú®|Elige paz.|‚òÆÔ∏è|Eres valiente crees.|ü¶Å|Conf√≠a proceso.|üîÑ|Eres amor humano.|üíó|Sonr√≠e lejos llegaste.|üòä|Eres historia orgullo.|üìñ|Agradece por ti.|üôè|Eres prueba puede.|üèÜ|Todo saldr√° bien.|üåà|Eres suficiente siempre ser√°s.|‚≠ê";
        
        const messages = phrases.split('|').reduce((acc, item, index, arr) => {
            if (index % 2 === 0 && arr[index + 1]) {
                acc.push({ text: item, icon: arr[index + 1] });
            }
            return acc;
        }, []);

        const hashtags = ["#EresLuz", "#D√≠aBrillante", "#MotivoDeAlegr√≠a", "#TuEsencia", "#Energ√≠aPositiva", "#ValorInterior", "#BrillaPorTi", "#T√∫Importas", "#AmorPropio", "#FuerzaInterior", "#CadaD√≠aCuenta", "#T√∫Brillas", "#AlmaHermosa", "#TuPresencia", "#EresMagia", "#TuVoz", "#Coraz√≥nValiente", "#Esencia√önica", "#TuSonrisa", "#GraciasPorSer"];

        // Detectar clima seg√∫n la hora y API
        async function detectWeather() {
            const hour = new Date().getHours();
            
            // Modo nocturno autom√°tico (8pm - 6am)
            if (hour >= 20 || hour < 6) {
                applyWeatherTheme('night');
                return;
            }
            
            // Intentar obtener clima real si hay API key
            if (WEATHER_API_KEY !== 'TU_API_KEY_AQUI') {
                try {
                    const pos = await getCurrentPosition();
                    const response = await fetch(
                        `https://api.openweathermap.org/data/2.5/weather?lat=${pos.latitude}&lon=${pos.longitude}&appid=${WEATHER_API_KEY}`
                    );
                    const data = await response.json();
                    
                    // Detectar si est√° lloviendo
                    const weatherCode = data.weather[0].id;
                    if (weatherCode >= 200 && weatherCode < 600) {
                        applyWeatherTheme('rainy');
                        return;
                    }
                } catch (error) {
                    console.log('No se pudo obtener el clima, usando modo soleado');
                }
            }
            
            // Por defecto: soleado
            applyWeatherTheme('sunny');
        }
        
        function getCurrentPosition() {
            return new Promise((resolve, reject) => {
                if (!navigator.geolocation) {
                    reject(new Error('Geolocation not supported'));
                } else {
                    navigator.geolocation.getCurrentPosition(
                        position => resolve({
                            latitude: position.coords.latitude,
                            longitude: position.coords.longitude
                        }),
                        error => reject(error)
                    );
                }
            });
        }
        
        function applyWeatherTheme(weather) {
            currentWeather = weather;
            document.body.className = weather;
            
            const effectsContainer = document.getElementById('weatherEffects');
            effectsContainer.innerHTML = '';
            
            if (weather === 'sunny') {
                document.getElementById('themeColor').setAttribute('content', '#87CEEB');
                createSun(effectsContainer);
                createClouds(effectsContainer, 3);
            } else if (weather === 'night') {
                document.getElementById('themeColor').setAttribute('content', '#0B1026');
                createMoon(effectsContainer);
                createStars(effectsContainer, 50);
            } else if (weather === 'rainy') {
                document.getElementById('themeColor').setAttribute('content', '#4A5568');
                createRain(effectsContainer, 100);
                createLightning(effectsContainer);
                createClouds(effectsContainer, 5, true);
            }
        }
        
        function createSun(container) {
            const sun = document.createElement('div');
            sun.className = 'sun';
            container.appendChild(sun);
        }
        
        function createMoon(container) {
            const moon = document.createElement('div');
            moon.className = 'moon';
            container.appendChild(moon);
        }
        
        function createStars(container, count) {
            for (let i = 0; i < count; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.width = Math.random() * 3 + 1 + 'px';
                star.style.height = star.style.width;
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 3 + 's';
                container.appendChild(star);
            }
        }
        
        function createClouds(container, count, dark = false) {
            for (let i = 0; i < count; i++) {
                const cloud = document.createElement('div');
                cloud.className = 'cloud';
                cloud.style.width = Math.random() * 100 + 80 + 'px';
                cloud.style.height = Math.random() * 40 + 30 + 'px';
                cloud.style.top = Math.random() * 30 + 10 + '%';
                cloud.style.left = -200 + 'px';
                cloud.style.animationDuration = Math.random() * 40 + 40 + 's';
                cloud.style.animationDelay = Math.random() * 20 + 's';
                if (dark) {
                    cloud.style.background = 'rgba(100, 100, 120, 0.6)';
                    if (cloud.querySelector('::before')) cloud.querySelector('::before').style.background = 'rgba(100, 100, 120, 0.6)';
                    if (cloud.querySelector('::after')) cloud.querySelector('::after').style.background = 'rgba(100, 100, 120, 0.6)';
                }
                container.appendChild(cloud);
            }
        }
        
        function createRain(container, count) {
            for (let i = 0; i < count; i++) {
                const drop = document.createElement('div');
                drop.className = 'raindrop';
                drop.style.left = Math.random() * 100 + '%';
                drop.style.animationDuration = Math.random() * 0.5 + 0.5 + 's';
                drop.style.animationDelay = Math.random() * 2 + 's';
                container.appendChild(drop);
            }
        }
        
        function createLightning(container) {
            const lightning = document.createElement('div');
            lightning.className = 'lightning';
            container.appendChild(lightning);
        }
        
        function getDayOfYear(date) {
            const start = new Date(date.getFullYear(), 0, 1);
            return Math.floor((date - start) / 86400000) + 1;
        }
        
        function isBirthday(date, birthdayDate) {
            const checkDate = new Date(date.getTime());
            const birthDate = new Date(birthdayDate.getTime());
            checkDate.setHours(12, 0, 0, 0);
            birthDate.setHours(12, 0, 0, 0);
            return checkDate.getMonth() === birthDate.getMonth() && checkDate.getDate() === birthDate.getDate();
        }
        
        function createConfetti() {
            const colors = ['#ff9a76', '#ffd700', '#ff69b4', '#87ceeb', '#98fb98', '#ffb6c1'];
            const shapes = ['‚óè', '‚ñ†', '‚ñ≤', '‚òÖ'];
            for (let i = 0; i < 100; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.textContent = shapes[Math.floor(Math.random() * shapes.length)];
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.color = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDuration = Math.random() * 2 + 3 + 's';
                    document.body.appendChild(confetti);
                    setTimeout(() => confetti.remove(), 5000);
                }, i * 20);
            }
        }
        
        function login() {
            const name = document.getElementById('userName').value;
            const birthdayInput = document.getElementById('userBirthday').value;
            if (!name || !birthdayInput) return alert('Por favor completa todos los campos');
            
            const [year, month, day] = birthdayInput.split('-');
            const birthday = new Date(parseInt(year), parseInt(month) - 1, parseInt(day), 12, 0, 0);
            
            userData = {name, birthday};
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('widgetScreen').classList.remove('hidden');
            detectWeather();
            updateDisplay();
        }
        
        function updateDisplay() {
            const today = new Date();
            today.setHours(0,0,0,0);
            const selected = new Date(currentDate);
            selected.setHours(0,0,0,0);
            
            const dayOfYear = getDayOfYear(currentDate);
            const message = messages[dayOfYear - 1] || messages[0];
            
            document.getElementById('dayNumber').textContent = `D√≠a ${dayOfYear}`;
            document.getElementById('dateDisplay').textContent = currentDate.toLocaleDateString('es-ES', {
                weekday: 'long',
                day: 'numeric',
                month: 'long',
                year: 'numeric'
            });
            
            // Icono seg√∫n clima
            if (currentWeather === 'sunny') {
                document.getElementById('weatherIcon').textContent = '‚òÄÔ∏è';
            } else if (currentWeather === 'night') {
                document.getElementById('weatherIcon').textContent = 'üåô';
            } else if (currentWeather === 'rainy') {
                document.getElementById('weatherIcon').textContent = 'üåßÔ∏è';
            }
            
            const dateKey = selected.toDateString();
            document.getElementById('reflectionText').value = reflections[dateKey] || '';
            
            const birthdaySpecial = document.getElementById('birthdaySpecial');
            
            if (userData && isBirthday(selected, userData.birthday)) {
                createConfetti();
                birthdaySpecial.innerHTML = `
                    <div class="birthday-special">
                        <div class="birthday-emoji">üéÇ</div>
                        <div class="birthday-text">¬°FELIZ CUMPLEA√ëOS ${userData.name.toUpperCase()}!</div>
                        <div style="margin-top: 10px; font-size: 0.9em; color: white;">üéâ Que todos tus sue√±os se hagan realidad ‚ú®</div>
                    </div>
                `;
            } else {
                birthdaySpecial.innerHTML = '';
            }
            
            if (selected > today) {
                document.getElementById('messageText').innerHTML = '<span class="locked-message">üîí Este mensaje estar√° disponible cuando llegue este d√≠a.</span>';
                document.getElementById('hashtag').textContent = '#ProntoLlegar√°';
                document.getElementById('nextBtn').disabled = true;
                document.getElementById('reflectionText').disabled = true;
            } else {
                document.getElementById('messageText').textContent = message.text;
                document.getElementById('hashtag').textContent = hashtags[dayOfYear % hashtags.length];
                document.getElementById('reflectionText').disabled = false;
                
                const tomorrow = new Date(selected);
                tomorrow.setDate(tomorrow.getDate() + 1);
                document.getElementById('nextBtn').disabled = tomorrow > today;
            }
        }
        
        document.getElementById('reflectionText').addEventListener('input', function() {
            const dateKey = new Date(currentDate).toDateString();
            reflections[dateKey] = this.value;
        });
        
        function showToday() {
            currentDate = new Date();
            detectWeather();
            updateDisplay();
        }
        
        function previousDay() {
            currentDate.setDate(currentDate.getDate() - 1);
            updateDisplay();
        }
        
        function nextDay() {
            currentDate.setDate(currentDate.getDate() + 1);
            updateDisplay();
        }
        
        // Detectar clima cada 10 minutos
        setInterval(detectWeather, 600000);
        
        // Aplicar tema inicial
        detectWeather();
        
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js')
                    .catch(err => console.log('Service Worker no disponible'));
            });
        }
    </script>
</body>
</html>
